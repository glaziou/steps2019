--- 
title: "Enquête STEP 2019, Polynésie Française"
subtitle: "Step 1, Questionnaire"
output:  
  html_document: 
    mode: selfcontained
    toc: yes 
    toc_float: true
    number_sections: false
    theme: flatly
fig_width: 12 
fig_caption: FALSE 
lang: fr
--- 

```{r setup, include=FALSE} 
# Chapter 1
# Set options, load data, utility functions 
knitr::opts_chunk$set(
  echo = FALSE,
  results = "asis",
  message = FALSE,
  warning = FALSE
)
library(data.table)
library(here)
library(knitr)
library(kableExtra)
library(gtsummary)
library(flextable)
library(survey)
library(gt)

load(here('data/report.Rdata'))

theme_gtsummary_language('fr')
theme_gtsummary_journal('lancet')

``` 

## 1.1 Tabac 

### Tableau 1.1.1a Fumeurs de produits à base de tabac (Question T1)
```{r tab_1_1_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(tobacco.T1), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    t1 = yesno(tobacco.T1),
                                    T1 = yesno(tobacco.T1, T, "Fumeur de tabac"))]
)

tbl_svysummary(d,
               include = c(T1),
               label = list(T1 ~ "Fumeur"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |> 
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```

### Tableau 1.1.1b Fumeurs, par âge (T1)
```{r tab_1_1_1b}
tab <- svyby( ~ t1, ~ agegr, d, svymean, vartype = c("ci"))
tab[, 2:4] <- round(tab[, 2:4] * 100)
names(tab) <- c('Age', 'fumeur', 'lo', 'hi')
tab$ic <- paste0(tab$fumeur, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[5] <- "Fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1, 5)]
gt::gt(tab) |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.1.1c Fumeurs, par âge et sexe (T1)
```{r tab_1_1_1c}
tab <- svyby( ~ t1, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'fumeur', 'lo', 'hi')
tab$gros <- paste0(tab$fumeur, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.1.2a Fumeurs quotidiens, parmi les fumeurs (T2)
```{r tab_1_1_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & !is.na(tobacco.T2), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    t2 = yesno(tobacco.T2),
                                    T2 = yesno(tobacco.T2, T, "Fumeur quotidien"))]
)

tbl_svysummary(d,
               include = c(T2),
               missing = "no",
               label = list(T2 ~ "Fumeur quotidien"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |> 
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.1.2b Fumeurs quotidiens, par âge et sexe (T2)
```{r tab_1_1_2b}
tab <- svyby( ~ t2, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumeur quotidien (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.3a Age de la première cigarette (T3)
```{r tab_1_1_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 !is.na(tobacco.T3) & tobacco.T3!=77, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    t3 = factor(as.integer(tobacco.T2 >=15 | tobacco.T3 < 20), 
                                                levels=0:1, labels=c('Non','Oui')),
                                    tobacco.T3)]
)

tbl_svysummary(
  d,
  include = c(tobacco.T3, t3),
  label = list(
    tobacco.T3 ~ "Age de le première cigarette",
    t3 ~ "Première cigarette entre 15 et 20 ans"),
  statistic = list(tobacco.T3 ~ "{mean}", 
                   t3 ~ "{p}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne/Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.1.3b Age de la première cigarette, par âge et sexe (T3)

```{r tab_1_1_3b}
tab <- svyby( ~ tobacco.T3, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "1ère cigarette (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.1.4a Nombre de cigarettes industrielles fumées par jour (T5a)
```{r tab_1_1_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 tobacco.T5a>0, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    tobacco.T5a)]
)

tbl_svysummary(
  d,
  include = c(tobacco.T5a),
  label = list(
    tobacco.T5a ~ "Nombre de cigarettes industrielles fumées par jour"),
    statistic = list(tobacco.T5a ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.1.4b Nombre de cigarettes industrielles fumées par jour, par âge et sexe (T5a)
```{r tab_1_1_4b}
tab <- svyby( ~ tobacco.T5a, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de cigarette médian"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.1.5a Nombre de cigarettes industrielles fumées par semaine (T5aw)
```{r tab_1_1_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 tobacco.T5aw>0, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    tobacco.T5aw)]
)

tbl_svysummary(
  d,
  include = c(tobacco.T5aw),
  label = list(
    tobacco.T5aw ~ "Nombre de cigarettes industrielles fumées par semaine"),
    statistic = list(tobacco.T5aw ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.1.5b Nombre de cigarettes industrielles fumées par semaine, par âge et sexe (T5aw)
```{r tab_1_1_5b}
tab <- svyby( ~ tobacco.T5aw, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$lo[tab$lo<0] <- 0 # avoid negative values in low bounds
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de cigarette médian"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.6a Nombre de cigarettes roulées par jour (T5b)
```{r tab_1_1_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 tobacco.T5b>0, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    tobacco.T5b)]
)

tbl_svysummary(
  d,
  include = c(tobacco.T5b),
  label = list(
    tobacco.T5b ~ "Nombre de cigarettes industrielles fumées par jour"),
    statistic = list(tobacco.T5b ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.1.6b Nombre de cigarettes industrielles fumées par jour, par âge et sexe (T5b)
```{r tab_1_1_6b}
tab <- svyby( ~ tobacco.T5b, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de cigarettes moyen (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.7a Nombre de cigarettes roulées par semaine (T5bw)
```{r tab_1_1_7a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 tobacco.T5bw>0, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    tobacco.T5bw)]
)

tbl_svysummary(
  d,
  include = c(tobacco.T5bw),
  label = list(
    tobacco.T5bw ~ "Nombre de cigarettes industrielles fumées par semaine"
  ),
  type = list(tobacco.T5bw ~ 'continuous'),
  statistic = list(tobacco.T5bw ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.1.7b Nombre de cigarettes industrielles fumées par semaine, par âge et sexe (T5bw)
```{r tab_1_1_7b}
tab <- svyby( ~ tobacco.T5bw, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$lo[tab$lo<0] <- 0 # avoid negative values in low bounds
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de cigarette (IC95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.1.8a Essayé d'arrêter de fumer lors des 12 derniers mois (T6)
```{r tab_1_1_8a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 !is.na(tobacco.T6), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,                                    
                                    t6 = yesno(tobacco.T6),
                                    T6 = yesno(tobacco.T6, T, "A essayé d'arrêter de fumer"))]
)

tbl_svysummary(d,
               include = c(T6),
               label = list(T6 ~ "Essayé d'arrêter"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.1.8b Essayé d'arrêter de fumer lors des 12 derniers mois, par âge et sexe (T6)
```{r tab_1_1_8b}
tab <- svyby( ~ t6, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Essayé d'arrêter (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.9a Un professionnel conseille d'arrêter de fumer lors des 12 derniers mois (T7)
```{r tab_1_1_9a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 tobacco.T7<3, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,                                    
                                    t7 = yesno(tobacco.T7),
                                    T7 = yesno(tobacco.T7, T, "A été conseillé d'arrêter de fumer"))]
)

tbl_svysummary(d,
               include = c(T7),
               label = list(T7 ~ "Conseil d'arrêter"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.1.9b Un professionnel conseille d'arrêter de fumer lors des 12 derniers mois, par âge et sexe (T7)
```{r tab_1_1_9b}
tab <- svyby( ~ t7, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Conseil d'arrêter (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.1.10a Ancien fumeurs de produits à base de tabac (ayant cessé de fumer)  (T8)
```{r tab_1_1_10a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(tobacco.T8), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    t8 = yesno(tobacco.T8),
                                    T8 = yesno(tobacco.T8, T, "Ancien fumeur de tabac"))]
)

tbl_svysummary(d,
               include = c(T8),
               label = list(T8 ~ "Ancien fumeur"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```

### Tableau 1.1.10b Ancien fumeurs, par âge et sexe (T8)
```{r tab_1_1_10b}
tab <- svyby( ~ t8, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Ancien fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.11a Ancien fumeurs quotidiens de produits à base de tabac (ayant cessé de fumer) (T9)
```{r tab_1_1_11a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & !is.na(tobacco.T9), .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    t9 = yesno(tobacco.T9),
    T9 = yesno(tobacco.T9, T, "Ancien fumeur quotidien")
  )]
)

tbl_svysummary(d,
               include = c(T9),
               label = list(T9 ~ "Ancien fumeur quotidien"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```

### Tableau 1.1.11b Ancien fumeurs quotidiens, par âge et sexe (T9)
```{r tab_1_1_11b}
tab <- svyby( ~ t9, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Ancien fumeur quotidien (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.12a Quelqu'un a fumé au domicile lors des 30 derniers jours (T17)
```{r tab_1_1_12a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & 
                 !is.na(tobacco.T17), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,                                    
                                    t17 = yesno(tobacco.T17),
                                    T17 = yesno(tobacco.T17, T, "Quelqu'un a fumé au domicile"))]
)

tbl_svysummary(d,
               include = c(T17),
               label = list(T17 ~ "Fumé au domicile"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```
### Tableau 1.1.12b Quelqu'un a fumé au domicile lors des 30 derniers jours, par âge et sexe (T17)
```{r tab_1_1_12b}
tab <- svyby( ~ t17, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumé au domicile (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.1.13a Quelqu'un a fumé dans un lieu clos au travail lors des 30 derniers jours (T18)
```{r tab_1_1_13a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & 
                 tobacco.T18 %in% 1:2, .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,                                    
                                    t18 = yesno(tobacco.T18),
                                    T18 = yesno(tobacco.T18, T, "Quelqu'un a fumé au travail"))]
)

tbl_svysummary(d,
               include = c(T18),
               label = list(T18 ~ "Fumé au travail"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```
### Tableau 1.1.13b Quelqu'un a fumé dans un lieu clos au travail lors des 30 derniers jours, par âge et sexe (T18)
```{r tab_1_1_13b}
tab <- svyby( ~ t18, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumé au travail (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```





## 1.2 Pakalolo

### Tableau 1.2.1a Fumeur de pakalolo (X2)
```{r tab_1_2_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(paka.X2), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    x2 = yesno(paka.X2),
                                    X2 = yesno(paka.X2, T, "Fumeur de pakalolo"))]
)

tbl_svysummary(d,
               include = c(X2),
               label = list(X2 ~ "Fumeur"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```

### Tableau 1.2.1b Fumeurs, par âge et sexe (X2)
```{r tab_1_2_1b}
tab <- svyby( ~ x2, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.2.2a Age de la première cigarette de pakalolo (X3)
```{r tab_1_2_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & paka.X2 == 1 &
                 !is.na(paka.X3), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    paka.X3)]
)

tbl_svysummary(
  d,
  include = c(paka.X3),
  label = list(
    paka.X3 ~ "Age de le première cigarette"),
  statistic = list(paka.X3 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```
### Tableau 1.2.2b Age de la première cigarette, par âge et sexe (X3)
```{r tab_1_2_2b}
tab <- svyby( ~ paka.X3, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "1ère cigarette (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.2.3a Fumeur de pakalolo au cours des 12 derniers mois (X4)
```{r tab_1_2_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(paka.X4), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    x4 = yesno(paka.X4),
                                    X4 = yesno(paka.X4, T, "Fumeur de paka au cours des 12 derniers mois"))]
)

tbl_svysummary(d,
               include = c(X4),
               label = list(X4 ~ "Fumeur"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```

### Tableau 1.2.3b Fumeurs, par sexe (X4)
```{r tab_1_2_3b}
tab <- svyby( ~ x4, ~ sexe, d, svymean, vartype = c("ci"))
tab[, 2:4] <- round(tab[, 2:4] * 100)
names(tab) <- c('Sexe', 'Fumeur', 'lo', 'hi')
tab$gros <- paste0(tab$Fumeur, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[5] <- "Fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1, 5)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.2.3c Fumeurs, par âge et sexe (X4)
```{r tab_1_2_3c}
tab <- svyby( ~ x4, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Fumeur (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```





### Tableau 1.2.4a Fumeur de pakalolo au cours des 12 derniers mois : fréquence (X5)
```{r tab_1_2_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(paka.X5), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    X5 = freq5(paka.X5))]
)

tbl_svysummary(d,
               include = c(X5),
               label = list(X5 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.2.4b Fréquence, par sexe (X5)
```{r tab_1_2_4b}
tbl_svysummary(d,
               include = c(X5, sexe),
               label = list(X5 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels()

```

### Tableau 1.2.4c Fréquence, par âge (X5)
```{r tab_1_2_4c}
tbl_svysummary(d,
               include = c(X5, agegr),
               label = list(X5 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = agegr) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Groupe d'âge**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels()

```



### Tableau 1.2.5a Fumeur de pakalolo au moins une fois par semaine : âge de début (X6)
```{r tab_1_2_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & tobacco.T2==1 &
                 !is.na(paka.X6), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    paka.X6)]
)

tbl_svysummary(
  d,
  include = c(paka.X6),
  label = list(paka.X6 ~ "Age de début du pakalolo"),
  statistic = list(paka.X6 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.2.5b Age de début, par âge et sexe (X6)
```{r tab_1_2_5b}
tab <- svyby( ~ paka.X6, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Age de début du pakalolo (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tablean 1.2.6 Fumeur de pakalolo et consommation d'alcool au même moment (X7)
```{r tab_1_2_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(paka.X7), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    X7 = freq4(paka.X7))]
)

tbl_svysummary(d,
               include = c(X7),
               label = list(X7 ~ "Pakalolo et alcool"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.2.6b Fréquence, par sexe (X7)
```{r tab_1_2_6b}
tbl_svysummary(d,
               include = c(X7, sexe),
               label = list(X7 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels()

```

### Tableau 1.2.6c Fréquence, par âge (X7)
```{r tab_1_2_6c}
tbl_svysummary(d,
               include = c(X7, agegr),
               label = list(X7 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = agegr) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Groupe d'âge**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels()

```



### Tableau 1.2.6d Fréquence, par archipel
```{r tab_1_2_6d}
tbl_svysummary(d,
               include = c(X7),
               label = list(X7 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = gstratum) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Archipel**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels()

```



## 1.3 Alcool 

### Tableau 1.3.1a Ayant déjà consommé de l'alcool (A1)

```{r tab_1_3_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alcohol.A1), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    a1 = yesno(alcohol.A1),
                                    A1 = yesno(alcohol.A1, T, "A déjà consommé de l'alcool"))]
)

tbl_svysummary(d,
               include = c(A1),
               label = list(A1 ~ "A consommé de l'alcool"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.3.1b Déjà consommé, par âge et sexe (A1)

```{r tab_1_3_1b}
tab <- svyby( ~ a1, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "A consommé de l'alcool (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.2a Ayant consommé de l'alcool ces 12 derniers mois (A2)

```{r tab_1_3_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alcohol.A2), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    a2 = yesno(alcohol.A2),
                                    A2 = yesno(alcohol.A2, T, "A consommé de l'alcool ces 12 derniers mois"))]
)

tbl_svysummary(d,
               include = c(A2),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.3.2b Ayant consommé de l'alcool ces 12 derniers mois, par âge et sexe (A2)

```{r tab_1_3_2b}
tab <- svyby( ~ a2, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Consommé de l'alcool ces 12 derniers mois (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.3a Ayant arrêté de boire de l'alcool pour raison de santé (A3)

```{r tab_1_3_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alcohol.A3), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    a3 = yesno(alcohol.A3),
                                    A3 = yesno(alcohol.A3, T, "A arrêté de boire pour raison de santé"))]
)

tbl_svysummary(d,
               include = c(A3),
               label = list(A3 ~ "Consommé de l'alcool ces 12 derniers mois"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.3.3b Ayant arrêté de boire de l'alcool, par âge et sexe (A3)

```{r tab_1_3_3b}
tab <- svyby( ~ a3, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Consommé de l'alcool ces 12 derniers mois (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tablean 1.3.4 Fréquence de consommation d'un verre standard d'alcool ces 12 derniers mois (A4)
```{r tab_1_3_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alcohol_standard_drinks.A4), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    A4 = freq7(alcohol_standard_drinks.A4))]
)

tbl_svysummary(d,
               include = c(A4),
               label = list(A4 ~ "Fréquence de consommation d'un verre"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.4b Fréquence, par sexe (A4)
```{r tab_1_3_4b}
tbl_svysummary(d,
               include = c(A4, sexe),
               label = list(A4 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```

### Tableau 1.3.4c Fréquence, par âge (A4)
```{r tab_1_3_4c}
tbl_svysummary(d,
               include = c(A4, agegr),
               label = list(A4 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = agegr) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Groupe d'âge**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tableau 1.3.4d Fréquence, par Archipel (A4)
```{r tab_1_3_4d}
tbl_svysummary(d,
               include = c(A4),
               label = list(A4 ~ "Fréquence (12 derniers mois)"),
               statistic = list(all_categorical() ~ "{p}"),
               by = gstratum) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Archipel**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tableau 1.3.5a Ayant consommé de l'alcool ces 30 derniers jours (A5)

```{r tab_1_3_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(A5), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    a5 = yesno(A5),
                                    A5 = yesno(A5, T, "A bu de l'alcool ces 30 derniers jours"))]
)

tbl_svysummary(d,
               include = c(A5),
               label = list(A5 ~ "Consommé de l'alcool ces 30 derniers jours"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.3.5b Ayant consommé de l'alcool ces 30 derniers jours, par âge et sexe (A5)

```{r tab_1_3_5b}
tab <- svyby( ~ a5, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Consommé de l'alcool ces 12 derniers mois (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.3.6a Au cours des 30 derniers jours, à combien d'occasions avez-vous bu au moins un verre d'alcool (A6)

```{r tab_1_3_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(A6) & A6 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          A6)]
)

tbl_svysummary(
  d,
  include = c(A6),
  label = list(A6 ~ "Nombre d'occasions"),
  statistic = list(A6 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```
### Tableau 1.3.6b Nombre d'occasions, par âge et sexe (A6)
```{r tab_1_3_6b}
tab <- svyby( ~ A6, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'occasions (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.7a Au cours des 30 derniers jours, nombre moyen de verres d'alcool bus par occasion (A7)

```{r tab_1_3_7a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(A7) & A7 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          A7)]
)

tbl_svysummary(
  d,
  include = c(A7),
  label = list(A7 ~ "Nombre de verres"),
  statistic = list(A7 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.7b Nombre de verres, par âge et sexe (A7)
```{r tab_1_3_7b}
tab <- svyby( ~ A7, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de verres (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.3.8a Consommation d'alcool en g/j au cours des 30 derniers jours

```{r tab_1_3_8a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alc.gpd) & alc.gpd != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          alc.gpd)]
)

tbl_svysummary(
  d,
  include = c(alc.gpd),
  missing = 'no',
  label = list(alc.gpd ~ "Grammes par jour"),
  statistic = list(alc.gpd ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.8b Consommation d'alcool en g/j au cours des 30 derniers jours, par âge et sexe 
```{r tab_1_3_8b}
tab <- svyby( ~ alc.gpd, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Grammes par jour (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.9a Pourcentage de la population en catégorie II (OMS, consommation d'alcool ces 30 derniers jours comprise entre 40 et 60 g/j)

```{r tab_1_3_9a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alc.cat2), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    var = yesno(alc.cat2),
                                    Var = yesno(alc.cat2, T, "Catégorie II"))]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Catégorie II (OMS)"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.3.9b Pourcentage de la population en catégorie II (OMS), par âge et sexe

```{r tab_1_3_9b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Consommé de l'alcool ces 12 derniers mois (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.10a Pourcentage de la population en catégorie III (OMS, consommation d'alcool ces 30 derniers jours supérieure à 60 g/j)

```{r tab_1_3_10a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alc.cat2), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    var = yesno(alc.cat3),
                                    Var = yesno(alc.cat3, T, "Catégorie III"))]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Catégorie III (OMS)"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.3.10b Pourcentage de la population en catégorie III (OMS), par âge et sexe

```{r tab_1_3_10b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Catégorie III (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.11a Consommation d'alcool en g/j au cours des 7 derniers jours

```{r tab_1_3_11a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alc.gpd7) & alc.gpd7 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          alc.gpd7)]
)

tbl_svysummary(
  d,
  include = c(alc.gpd7),
  missing = 'no',
  label = list(alc.gpd7 ~ "Grammes par jour"),
  statistic = list(alc.gpd7 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.11b Consommation d'alcool en g/j au cours des 7 derniers jours, par âge et sexe 
```{r tab_1_3_11b}
tab <- svyby( ~ alc.gpd7, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Grammes par jour (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.3.12a Au cours des 30 derniers jours, plus grand nombre de verres d'alcool bus en une fois (A8)

```{r tab_1_3_12a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(A8) & A8 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          A8)]
)

tbl_svysummary(
  d,
  include = c(A8),
  label = list(A8 ~ "Nombre de verres"),
  statistic = list(A8 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.12b Plus grand nombre de verres en une fois, par âge et sexe (A8)

```{r tab_1_3_12b}
tab <- svyby( ~ A8, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de verres (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.3.13a Au cours des 30 derniers jours, nombre de fois au moins 6 verres d'alcool ont été bus en une occasion (A9)

```{r tab_1_3_13a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(A9) & A9 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          A9)]
)

tbl_svysummary(
  d,
  include = c(A9),
  label = list(A9 ~ "Nombre de fois"),
  statistic = list(A9 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.13b Nombre de fois au moins 6 verres, par âge et sexe (A9)

```{r tab_1_3_13b}
tab <- svyby( ~ A9, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de fois (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.3.14a Au cours des 7 derniers jours, nombre de verres d'alcool ont été bus par jour (A10)

```{r tab_1_3_14a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(alcweek.A10a) &
                 !is.na(alcweek.A10b) &
                 !is.na(alcweek.A10c) &
                 !is.na(alcweek.A10d) &
                 !is.na(alcweek.A10e) &
                 !is.na(alcweek.A10f) &
                 !is.na(alcweek.A10g), .(
                   uid,
                   w1,
                   gstratum,
                   agegr,
                   bmigr,
                   Sexe = sexe,
                   Lundi = alcweek.A10a,
                   Mardi = alcweek.A10b,
                   Mercredi = alcweek.A10c,
                   Jeudi = alcweek.A10d,
                   Vendredi = alcweek.A10e,
                   Samedi = alcweek.A10f,
                   Dimanche = alcweek.A10g
                 )]
)

tbl_svysummary(
  d,
  include = c(Lundi, Mardi, Mercredi, Jeudi, Vendredi, Samedi, Dimanche),
  statistic = list(all_continuous() ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.14b Nombre de verres, par sexe (A10)
```{r tab_1_3_14b}
tbl_svysummary(
  d,
  include = c(Lundi, Mardi, Mercredi, Jeudi, Vendredi, Samedi, Dimanche),
  by = Sexe,
  statistic = list(all_continuous() ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels() 

```


### Tableau 1.3.14c Nombre de verres, par groupe d'âge (A10)
```{r tab_1_3_14c}
tbl_svysummary(
  d,
  include = c(Lundi, Mardi, Mercredi, Jeudi, Vendredi, Samedi, Dimanche),
  by = agegr,
  statistic = list(all_continuous() ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Age**",
                all_stat_cols() ~ "**{level} (IC 95%)**") |>
  bold_labels() 

```



### Tablean 1.3.15a Problèmes de famille à cause de l'alcool au cours des 12 derniers mois (A16)

```{r tab_1_3_15a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(al16.A16), .(uid,
                                    w1,
                                    gstratum,
                                    agegr,
                                    bmigr,
                                    sexe,
                                    A16 = freq5b(al16.A16))]
)

tbl_svysummary(d,
               include = c(A16),
               label = list(A16 ~ "Fréquence des problèmes"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.3.15b Fréquence, par sexe (A16)

```{r tab_1_3_15b}
tbl_svysummary(d,
               include = c(A16, sexe),
               label = list(A16 ~ "Fréquence des problèmes"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```

### Tableau 1.3.15c Fréquence, par âge (A16)

```{r tab_1_3_15c}
tbl_svysummary(d,
               include = c(A16, agegr),
               label = list(A16 ~ "Fréquence des problèmes"),
               statistic = list(all_categorical() ~ "{p}"),
               by = agegr) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Groupe d'âge**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```





## 1.4 Nutrition

### Tableau 1.4.1a Consommation de fruits: nombre de jours par semaine (D1)

```{r tab_1_4_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(diet.D1) & diet.D1 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          diet.D1)]
)

tbl_svysummary(
  d,
  include = c(diet.D1),
  label = list(diet.D1 ~ "Nombre de jours"),
  type = list(diet.D1 ~ 'continuous'),
  statistic = list(diet.D1 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.1b Nombre d'occasions, par âge et sexe (D1)

```{r tab_1_4_1b}
tab <- svyby( ~ diet.D1, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.4.2a Consommation de fruits: nombre de portions par jour (D2)

```{r tab_1_4_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(diet.fruits_serv.D2) & diet.fruits_serv.D2 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          diet.fruits_serv.D2)]
)

tbl_svysummary(
  d,
  include = c(diet.fruits_serv.D2),
  label = list(diet.fruits_serv.D2 ~ "Nombre de portions"),
  type = list(diet.fruits_serv.D2 ~ 'continuous'),
  statistic = list(diet.fruits_serv.D2 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.2b Nombre de portions, par âge et sexe (D2)

```{r tab_1_4_2b}
tab <- svyby( ~ diet.fruits_serv.D2, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de portions (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.4.3 Raisons de ne pas consommer plus de fruits (X8)

```{r tab_1_4_3}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    X8.1 = qcm(as.numeric(diet.X8.1), 2, value.lab = "Consommation de fruits est suffisante (X8.1)"),
    X8.2 = qcm(as.numeric(diet.X8.2), 2, value.lab = "Prix trop élevé (X8.2)"),
    X8.3 = qcm(as.numeric(diet.X8.3), 2, value.lab = "Difficultés d'approvisionnement (X8.3)"),
    X8.4 = qcm(as.numeric(diet.X8.4), 2, value.lab = "Préparation contraignante (X8.4)"),
    X8.5 = qcm(as.numeric(diet.X8.5), 2, value.lab = "Présence de pesticides (X8.5)"),
    X8.6 = qcm(as.numeric(diet.X8.6), 2, value.lab = "Absence d'arbres fruitiers (X8.6)"),
    X8.7 = qcm(as.numeric(diet.X8.7), 2, value.lab = "N'aime pas les fruits (X8.7)"),
    X8.8 = qcm(as.numeric(diet.X8.8), 2, value.lab = "Autre raison (X8.8)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    X8.1,
    X8.2,
    X8.3,
    X8.4,
    X8.5,
    X8.6,
    X8.7,
    X8.8
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.4.4a Consommation de légumes: nombre de jours par semaine (D3)

```{r tab_1_4_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 diet.D3 != 77, .(uid,
                                  w1,
                                  gstratum,
                                  agegr,
                                  bmigr,
                                  sexe,
                                  diet.D3)]
)

tbl_svysummary(
  d,
  include = c(diet.D3),
  label = list(diet.D3 ~ "Nombre de jours"),
  type = list(diet.D3 ~ 'continuous'),
  statistic = list(diet.D3 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.4b Nombre de jours, par âge et sexe (D3)

```{r tab_1_4_4b}
tab <- svyby( ~ diet.D3, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de portions (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.4.5 Raisons de ne pas consommer plus de légumes (X9)

```{r tab_1_4_5}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    X9.1 = qcm(as.numeric(diet.X9.1), 2, "Consommation de fruits est suffisante (X9.1)"),
    X9.2 = qcm(as.numeric(diet.X9.2), 2, "Prix trop élevé (X9.2)"),
    X9.3 = qcm(as.numeric(diet.X9.3), 2, "Difficultés d'approvisionnement (X9.3)"),
    X9.4 = qcm(as.numeric(diet.X9.4), 2, "Préparation contraignante (X9.4)"),
    X9.5 = qcm(as.numeric(diet.X9.5), 2, "Présence de pesticides (X9.5)"),
    X9.6 = qcm(as.numeric(diet.X9.6), 2, "Absence d'arbres fruitiers (X9.6)"),
    X9.7 = qcm(as.numeric(diet.X9.7), 2, "N'aime pas les légumes (X9.7)"),
    X9.8 = qcm(as.numeric(diet.X9.8), 2, "Autre raison (X9.8)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    X9.1,
    X9.2,
    X9.3,
    X9.4,
    X9.5,
    X9.6,
    X9.7,
    X9.8
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.4.6a Consommation de légumes: nombre de portions par jour (D4)

```{r tab_1_4_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(diet.vegetables_serv.D4) & diet.vegetables_serv.D4 != 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          diet.vegetables_serv.D4)]
)

tbl_svysummary(
  d,
  include = c(diet.vegetables_serv.D4),
  label = list(diet.vegetables_serv.D4 ~ "Nombre de portions"),
  type = list(diet.vegetables_serv.D4 ~ 'continuous'),
  statistic = list(diet.vegetables_serv.D4 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.6b Nombre de portions, par âge et sexe (D4)

```{r tab_1_4_6b}
tab <- svyby( ~ diet.vegetables_serv.D4, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de portions (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.4.7 Consommation de fruits et légumes: au moins 5 portions par jour

```{r tab_1_4_7}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w2,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 !is.na(bmigr), .(uid,
                                  w2,
                                  gstratum,
                                  agegr,
                                  bmigr,
                                  overweight,
                                  sexe,
                                  var = fruitleg5)]
)

tbl_svysummary(d,
               include = c(var),
               missing = 'no',
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Prévalence (IC 95%)**") |>
  bold_labels() |>
  remove_row_type(type='level', level_value = 'Moins de 5 portions') |>
  remove_row_type(type='header')

```




### Tablean 1.4.8a Ajouter du sel ou sauce de soja en mangeant (avant ou pendant) (D5)

```{r tab_1_4_8a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              D5 = freq5c(diet.salt.D5))]
)

tbl_svysummary(d,
               include = c(D5),
               missing = "no",
               label = list(D5 ~ "Fréquence d'ajout de sel"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.8b Fréquence, par sexe (D5)
```{r tab_1_4_8b}
tbl_svysummary(d,
               include = c(D5, sexe),
               missing = "no",
               label = list(D5 ~ "Fréquence d'ajout de sel"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```




### Tablean 1.4.9a Ajouter du sel ou sauce de soja en faisant la cuisine (D6)

```{r tab_1_4_9a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              D6 = freq5c(diet.salt.D6))]
)

tbl_svysummary(d,
               include = c(D6),
               missing = "no",
               label = list(D6 ~ "Fréquence d'ajout de sel"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.9b Fréquence, par sexe (D6)
```{r tab_1_4_9b}
tbl_svysummary(d,
               include = c(D6, sexe),
               missing = "no",
               label = list(D6 ~ "Fréquence d'ajout de sel"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.4.10a Manger des aliments riches en sel (D7)

```{r tab_1_4_10a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              D7 = freq5c(diet.salt.D7))]
)

tbl_svysummary(d,
               include = c(D7),
               missing = "no",
               label = list(D7 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.10b Fréquence, par sexe (D7)
```{r tab_1_4_10b}
tbl_svysummary(d,
               include = c(D7, sexe),
               missing = "no",
               label = list(D7 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.4.11a Quantité de sel consommée (D8)

```{r tab_1_4_11a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              D8 = freq5d(diet.salt.D8))]
)

tbl_svysummary(d,
               include = c(D8),
               missing = "no",
               label = list(D8 ~ "Quantité de sel"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.4.11b Quantité de sel, par sexe (D8)
```{r tab_1_4_11b}
tbl_svysummary(d,
               include = c(D8, sexe),
               missing = "no",
               label = list(D8 ~ "Quantité de sel"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```




## 1.5 Hygiène alimentaire

### Tableau 1.5.1 Attitudes alimentaires vis-à-vis du sel (D10, D11a-e)

```{r tab_1_5_1}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    D10 = qcm(diet.D10, 1, value.lab = "Trop de sel est source de problèmes (D10)"),
    D11a = qcm(diet.salt.D11a, 1, value.lab = "Il faut réduire les plats cuisinés salés (D11a)"),
    D11b = qcm(diet.salt.D11b, 1, value.lab = "Il faut vérifier la teneur en sel sur les étiquettes (D11b)"),
    D11d = qcm(diet.salt.D11d, 1, value.lab = "Il faut utiliser des épices autre que le sel (D11d)"),
    D11e = qcm(diet.salt.D11e, 1, value.lab = "Il faut éviter de manger hors du domicile (D11e)")
  )]
)

tbl_svysummary(
  d,
  include = c(D10, D11a, D11b, D11d, D11e),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')


```


### Tablean 1.5.2a Fréquence de consommations de boissons sucrées (X10)

```{r tab_1_5_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & diet.sugary_drinks.X10<6, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              X10 = freq5(diet.sugary_drinks.X10))]
)

tbl_svysummary(d,
               include = c(X10),
               missing = "no",
               label = list(X10 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.5.2b Fréquence, par sexe (X10)
```{r tab_1_5_2b}
tbl_svysummary(d,
               include = c(X10, sexe),
               missing = "no",
               label = list(X10 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tableau 1.5.3a Consommation de boissons sucrées: nombre de verres par jour (X11)

```{r tab_1_5_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 diet.sugary_drinks.X11 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          X11 = diet.sugary_drinks.X11)]
)

tbl_svysummary(
  d,
  include = c(X11),
  label = list(X11 ~ "Nombre de verres"),
  type = list(X11 ~ 'continuous'),
  statistic = list(X11 ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.5.3b Nombre de verres, par âge et sexe (X11)

```{r tab_1_5_3b}
tab <- svyby( ~ X11, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de verres (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tablean 1.5.4a Moment de consommation de boissons sucrées (X12)

```{r tab_1_5_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & diet.sugary_drinks.X10<4, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              X12 = freq3(diet.sugary_drinks.X12))]
)

tbl_svysummary(d,
               include = c(X12),
               missing = "no",
               label = list(X12 ~ "Moment"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.5.4b Fréquence, par sexe (X12)
```{r tab_1_5_4b}
tbl_svysummary(d,
               include = c(X12, sexe),
               missing = "no",
               label = list(X12 ~ "Moment"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.5.5a Fréquence de consommation de junk food (X13)

```{r tab_1_5_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & diet.X13<6, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              X13 = freq5(diet.X13))]
)

tbl_svysummary(d,
               include = c(X13),
               missing = "no",
               label = list(X13 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.5.5b Fréquence, par sexe (X13)
```{r tab_1_5_5b}
tbl_svysummary(d,
               include = c(X13, sexe),
               missing = "no",
               label = list(X13 ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```








## 1.6 Activité physique

### Tableau 1.6.1a Activité physique intense au travail (P1)

```{r tab_1_6_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = yesno(physical.P1.P1),
    Var = yesno(physical.P1.P1, T, "Activité physique intense au travail")
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique intense au travail"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.6.1b Activité intense au travail, par âge et sexe (P1)

```{r tab_1_6_1b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique intense au travail"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.2a Activités de forte intensité au travail: nombre de jours par semaine (P2)

```{r tab_1_6_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P2 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P2)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre de jours"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.2b Nombre de jours, par âge et sexe (P2)

```{r tab_1_6_2b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.3a Jours d'activités de forte intensité au travail: nombre d'heures par jour (P3)

```{r tab_1_6_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P3.P3a < 77 &
                 physical.P3.P3b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P3.P3a + physical.P3.P3b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.3b Nombre d'heures, par âge et sexe (P3)

```{r tab_1_6_3b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.4a Activité physique modérée au travail (P4)

```{r tab_1_6_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = yesno(physical.P1.P1),
    Var = yesno(physical.P1.P1, T, "Activité physique modérée au travail")
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique modérée au travail"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.4b Activité modérée au travail, par âge et sexe (P4)

```{r tab_1_6_4b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique modérée au travail (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.6.5a Activités d'intensité modérée au travail: nombre de jours par semaine (P5)

```{r tab_1_6_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P5 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P5)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre de jours"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.5b Nombre de jours, par âge et sexe (P5)

```{r tab_1_6_5b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.6a Jours d'activités de d'intensité modérée au travail: nombre d'heures par jour (P6)

```{r tab_1_6_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P6.P6a < 77 &
                 physical.P6.P6b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P6.P6a + physical.P6.P6b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.6b Nombre d'heures, par âge et sexe (P6)

```{r tab_1_6_6b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.7a Trajets d'au moins 10 minutes à pied ou à vélo (P7)

```{r tab_1_6_7a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = yesno(physical.P7),
    Var = yesno(physical.P7, T, "Trajets d'au mopins 10 minutes à pied ou à vélo")
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Trajet d'au moins 10 minutes"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.7b Trajets d'au moins 10 minutes, par âge et sexe (P7)

```{r tab_1_6_7b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Trajet d'au moins 10 minutes (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.6.8a Trajets d'au moins 10 minutes à pied ou à vélo: nombre de jours par semaine (P8)

```{r tab_1_6_8a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P8 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P8)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre de jours"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.8b Nombre de jours, par âge et sexe (P8)

```{r tab_1_6_8b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.9a Trajet habituel d'au moins 10 minutes: nombre d'heures par trajet (P9)

```{r tab_1_6_9a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P9.P9a < 77 &
                 physical.P9.P9b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P9.P9a + physical.P9.P9b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.9b Nombre d'heures, par âge et sexe (P9)

```{r tab_1_6_9b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.10a Sport intense (P10)

```{r tab_1_6_10a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = yesno(physical.P10.P10),
    Var = yesno(physical.P10.P10, T, "Sport intense")
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Sport intense"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.10b Sport intense, par âge et sexe (P10)

```{r tab_1_6_10b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Sport intense (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.6.11a Sport intense: nombre de jours par semaine (P11)

```{r tab_1_6_11a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P11 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P11)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre de jours"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.11b Nombre de jours, par âge et sexe (P11)

```{r tab_1_6_11b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.12a Sport intense: nombre d'heures par jour (P12)

```{r tab_1_6_12a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P12.P12a < 77 &
                 physical.P12.P12b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P12.P12a + physical.P12.P12b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.12b Nombre d'heures, par âge et sexe (P12)

```{r tab_1_6_12b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.13a Sport modéré (P13)

```{r tab_1_6_13a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = yesno(physical.P13.P13),
    Var = yesno(physical.P13.P13, T, "Sport modéré")
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Sport modéré"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.13b Sport modéré, par âge et sexe (P13)

```{r tab_1_6_13b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Sport modéré (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.6.14a Sport modéré: nombre de jours par semaine (P14)

```{r tab_1_6_14a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P14 < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P14)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre de jours"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.14b Nombre de jours, par âge et sexe (P14)

```{r tab_1_6_14b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre de jours (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.15a Sport modéré: nombre d'heures par jour (P15)

```{r tab_1_6_15a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P15.P15a < 77 &
                 physical.P15.P15b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P15.P15a + physical.P15.P15b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.15b Nombre d'heures, par âge et sexe (P15)

```{r tab_1_6_15b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.16a Comportement sédentaire: nombre d'heures par jour (P16)

```{r tab_1_6_16a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 &
                 physical.P16.P16a < 77 &
                 physical.P16.P16b < 77, .(uid,
                                          w1,
                                          gstratum,
                                          agegr,
                                          bmigr,
                                          sexe,
                                          var = physical.P16.P16a + physical.P16.P16b / 60)]
)

tbl_svysummary(
  d,
  include = c(var),
  label = list(var ~ "Nombre d'heures"),
  type = list(var ~ 'continuous'),
  statistic = list(var ~ "{mean}")
) |>
  modify_header(label ~ "") |>
  add_ci(pattern = "{stat} ({ci})") |>
  modify_header(stat_0 = "**Moyenne (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.6.16b Nombre d'heures, par âge et sexe (P16)

```{r tab_1_6_16b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5],1)
names(tab) <- c('Age', 'Sexe', 'Age1', 'lo', 'hi')
tab$gros <- paste0(tab$Age1, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Nombre d'heures (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```




### Tableau 1.6.17a Activité physique limitée

```{r tab_1_6_17a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.low,
    Var = factor(met.low, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(
  d,
  include = c(Var),
  label = list(Var ~ "Activité physique limitée"),
  statistic = list(all_categorical() ~ "{p}")
) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type = 'level', level_value = 'Non') |>
  remove_row_type(type = 'header')

# tbl_svysummary(
#   d,
#   include = c(Var),
#   by = agegr,
#   label = list(Var ~ "Activité physique limitée"),
#   statistic = list(all_categorical() ~ "{p}")
# ) |>
#   modify_header(label ~ "") |>
#   add_ci(
#     pattern = "{stat} ({ci})",
#     statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
#   )  |>
#   modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
#   bold_labels() |>
#   modify_footnote(update = everything() ~ NA) |>
#   remove_row_type(type = 'level', level_value = 'Non') |>
#   remove_row_type(type = 'header')

```

### Tableau 1.6.17b Activité physique limitée, par âge et sexe

```{r tab_1_6_17b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique limitée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.6.18a Activité physique modérée

```{r tab_1_6_18a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.med,
    Var = factor(met.med, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique modérée"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.18b Activité physique modére, par âge et sexe

```{r tab_1_6_18b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique modérée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.6.19a Activité physique élevée

```{r tab_1_6_19a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.high,
    Var = factor(met.high, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique élevée"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.19b Activité physique élevée, par âge et sexe

```{r tab_1_6_19b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique élevée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



### Tableau 1.6.20a Activité physique limitée au travail

```{r tab_1_6_20a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.work.low,
    Var = factor(met.work.low, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique limitée"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.20b Activité physique limitée au travail, par âge et sexe

```{r tab_1_6_20b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique limitée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```


### Tableau 1.6.21a Activité sportive limitée

```{r tab_1_6_21a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.sport.low,
    Var = factor(met.sport.low, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité sportive limitée"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.21b Activité sportive limitée, par âge et sexe

```{r tab_1_6_21b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique limitée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```

### Tableau 1.6.22a Activité physique en déplacement limitée 

```{r tab_1_6_22a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var = met.move.low,
    Var = factor(met.move.low, levels=1:0, labels=c('Oui','Non'))
  )]
)

tbl_svysummary(d,
               include = c(Var),
               label = list(Var ~ "Activité physique en déplacement limitée"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```

### Tableau 1.6.22b Activité physique en déplacement limitée, par âge et sexe

```{r tab_1_6_22b}
tab <- svyby( ~ var, ~ agegr + sexe, d, svymean, vartype = c("ci"))
tab[, 3:5] <- round(tab[, 3:5] * 100)
names(tab) <- c('Age', 'Sexe', 'obese', 'lo', 'hi')
tab$gros <- paste0(tab$obese, ' (', tab$lo, ' - ', tab$hi, ')')
names(tab)[6] <- "Activité physique en déplacement limitée (IC 95%)"
rownames(tab) <- NULL
tab <- tab[, c(1:2, 6)]
gt::gt(tab, groupname_col = 'Sexe') |> 
 gt::tab_style(
     locations = cells_column_labels(columns = everything()),
     style     = list(
       cell_text(weight = "bold")
     )
   )

```



## 1.7 Qualité de vie

### Tablean 1.7.1a Pensez-vous que votre santé est : (X14)

```{r tab_1_7_1a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5e(Life.X14))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.1b Qualification, par sexe (X14)
```{r tab_1_7_1b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.2a Etes-vous limité pour des efforts physiques modérés : (X15)

```{r tab_1_7_2a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq3b(Life.X15))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.2b Qualification, par sexe (X15)
```{r tab_1_7_2b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```




### Tablean 1.7.3a Etes-vous limité pour monter plusieurs étages par l'escalier : (X16)

```{r tab_1_7_3a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq3b(Life.X16))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.3b Qualification, par sexe (X16)
```{r tab_1_7_3b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```




### Tablean 1.7.4a Au cours des 4 dernières semaines,, en raison de votre état émotionnel, avez-vous accompli moins de choses que vous auriez souhaité : (X17)

```{r tab_1_7_4a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note12.X17))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.4b Qualification, par sexe (X17)
```{r tab_1_7_4b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.5a Avez-vous été limité pour faire certaines choses : (X18)

```{r tab_1_7_5a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note12.X18))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.5b Qualification, par sexe (X18)
```{r tab_1_7_5b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.6a Au cours des 4 dernières semaines, en raison de votre état physique, avez-vous été limité pour faire certaines choses : (X19)

```{r tab_1_7_6a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note14.X19))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.6b Qualification, par sexe (X19)
```{r tab_1_7_6b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.7a Avez-vous été limité pour faire certaines choses : (X20)

```{r tab_1_7_7a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note14.X20))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.7b Qualification, par sexe (X20)
```{r tab_1_7_7b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```




### Tablean 1.7.8a Au cours des 4 dernières semaines, en raison de votre état physique, dans quelle mesure vos douleurs physiques vous ont-elles limité dans votre travail ou vos activités domestiques : (X21)

```{r tab_1_7_8a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5g(note14.X21))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Qualification"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.8b Qualification, par sexe (X21)
```{r tab_1_7_8b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Qualification"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.9a Y a-til eu des moments où vous vous êtes senti calme et détendu : (X22)

```{r tab_1_7_9a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note16.X22))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Fréquence"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.9b Fréquence, par sexe (X22)
```{r tab_1_7_9b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.10a Y a-til eu des moments où vous vous êtes senti débordant d'énergie : (X23)

```{r tab_1_7_10a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note16.X23))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Fréquence"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.10b Fréquence, par sexe (X23)
```{r tab_1_7_10b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```



### Tablean 1.7.11a Y a-til eu des moments où vous vous êtes senti triste et abattu : (X24)

```{r tab_1_7_11a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note18.X24))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Fréquence"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.11b Fréquence, par sexe (X24)
```{r tab_1_7_11b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```





### Tablean 1.7.12a Y a-til eu des moments où vous vous êtes senti triste et abattu : (X25)

```{r tab_1_7_12a}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(uid,
                              w1,
                              gstratum,
                              agegr,
                              bmigr,
                              sexe,
                              var = freq5f(note18.X25))]
)

tbl_svysummary(d,
               include = c(var),
               missing = "no",
               label = list(var ~ "Fréquence"),
               type = var ~ "categorical",
               statistic = list(all_categorical() ~ "{p}")) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  bold_labels() |>
  modify_footnote(update = everything() ~ NA)

```

### Tableau 1.7.12b Fréquence, par sexe (X25)
```{r tab_1_7_12b}
tbl_svysummary(d,
               include = c(var, sexe),
               missing = "no",
               label = list(var ~ "Fréquence"),
               statistic = list(all_categorical() ~ "{p}"),
               by = sexe) |>
  modify_header(label ~ "") |>
  add_ci(
    pattern = "{stat} ({ci})",
    statistic = list(all_categorical() ~ "{conf.low} - {conf.high}")
  )  |>
  modify_header(label ~ "**Sexe**",
                all_stat_cols() ~ "**{level}**") |>
  bold_labels()

```





## 1.8 Antécédents

### Tableau 1.8.1 Antécédents d'HTA (H1-H5)

```{r tab_1_8_1}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    H1=yesno(hx_raised_bp.H1, T, "TA déjà mesurée par un professionnel (H1)"),
    H2a=yesno(hx_raised_bp.H2a, T, "Un professionnel vous a dit que vous aviez une TA élevée (H2a)"),
    H2b=yesno(hx_raised_bp.H2b, T, "Vous a t-on dit cela ces 12 derniers mois (H2b)"),
    H3=yesno(hx_raised_bp.H3, T, "Médicaments prescrits ces 2 dernières semaines pour HTA (H3)"),
    H4=yesno(hx_raised_bp.H4, T, "Avez vous vu un tahua pour votre HTA (H4)"),
    H5=yesno(hx_raised_bp.H5, T, "Prenez vous un remède traditionnel pour votre HTA (H5)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    H1,
    H2a,
    H2b,
    H3,
    H4,
    H5
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```



### Tableau 1.8.2 Antécédents de diabète (H6-H11)

```{r tab_1_8_2}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    H6=yesno(hx_diabetes.H6, T, "Glycémie déjà mesurée par un professionnel (H6)"),
    H7a=yesno(hx_diabetes.H7a, T, "Un professionnel vous a dit que vous aviez du diabète (H7a)"),
    H7b=yesno(hx_diabetes.H7b, T, "Vous a t-on dit cela ces 12 derniers mois (H7b)"),
    H8=yesno(hx_diabetes.H8, T, "Médicaments prescrits ces 2 dernières semaines pour le diabète (H8)"),
    H9=yesno(hx_diabetes.H9, T, "Insuline prescrite pour le diabète (H9)"),
    H10=yesno(hx_diabetes.H10, T, "Avez vous vu un tahua pour votre HTA (H10)"),
    H11=yesno(hx_diabetes.H11, T, "Prenez vous un remède traditionnel pour votre HTA (H11)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    H6,
    H7a,
    H7b,
    H8,
    H9,
    H10,
    H11
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```




### Tableau 1.8.3 Antécédents d'hypercholestérolémie (H12-H16)

```{r tab_1_8_3}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    H12=yesno(hx_chol.H12, T, "Cholestérol déjà mesurée par un professionnel (H12)"),
    H13a=yesno(hx_chol.H13a, T, "Un professionnel vous a dit que vous aviez un cholestérol élevé (H13a)"),
    H13b=yesno(hx_chol.H13b, T, "Vous a t-on dit cela ces 12 derniers mois (H13b)"),
    H14=yesno(hx_chol.H14, T, "Médicaments prescrits ces 2 dernières semaines pour le cholestérol élevé (H14)"),
    H15=yesno(hx_chol.H15, T, "Avez vous vu un tahua pour votre cholestérol élevé (H15)"),
    H16=yesno(hx_chol.H16, T, "Prenez vous un remède traditionnel pour votre HTA (H16)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    H12,
    H13a,
    H13b,
    H14,
    H15,
    H16
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```




### Tableau 1.8.4 Antécédents cardiovasculaires (H17)

```{r tab_1_8_4}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    H17=yesno(hx_cardiovascular.H17, T, "Avez-vous déjà eu une crise cardiaque ou angine de poitrine ou AVC (H17)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    H17
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```




### Tableau 1.8.5 Conseils pour le mode de vie (H20, H20a-H20g)

```{r tab_1_8_5}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    H20=yesno(lifestyle_advice.H20, T, "A consulté un professionnel au cours des 12 derniers mois (H20)"),
    H20a=yesno(lifestyle_advice.lifestyle.H20a, T, "Conseillé d'arrêter de fumer (H20a)"),
    H20b=yesno(lifestyle_advice.lifestyle.H20b, T, "Conseillé de réduire la consommation de sel (H20b)"),
    H20c=yesno(lifestyle_advice.lifestyle.H20c, T, "Conseillé de manger au moins 5 portions de frtuis et légumes par jour (H20c)"),
    H20d=yesno(lifestyle_advice.lifestyle.H20d, T, "Conseillé de réduire la consommation de graisse (H20d)"),
    H20e=yesno(lifestyle_advice.lifestyle.H20e, T, "Conseillé de commencer ou faire plus d'activités physiques (H20e)"),
    H20f=yesno(lifestyle_advice.lifestyle.H20f, T, "Conseillé de maintenir un pods sain ou perdre du poids (H20f)"),
    H20g=yesno(lifestyle_advice.lifestyle.H20g, T, "Conseillé de réduire la consommation de boissons sucrées (H20g)")
  )]
)

tbl_svysummary(
  d,
  include = c(
    H20,
    H20a,
    H20b,
    H20c,
    H20d,
    H20e,
    H20f,
    H20g
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```




### Tableau 1.8.6 Dépistage du cancer du col utérin (CX1)

```{r tab_1_8_6}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1 & sex == "F", .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    var=yesno(lifestyle_advice.cervical_cancer.CX1, T, "Déjà eu un dépistage du cancer du col utérin (CX1)")
  )]
)

tbl_svysummary(
  d,
  include = var,
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA) |>
  remove_row_type(type='level', level_value = 'Non') |>
  remove_row_type(type='header')

```


### Tableau 1.8.7 Longue maladie (X26-X27)

```{r tab_1_8_7}
d <- survey::svydesign(
  id = ~ uid,
  weights = ~ w1,
  strata = ~ gstratum + agegr,
  data = steps[enroll == 1, .(
    uid,
    w1,
    gstratum,
    agegr,
    bmigr,
    sexe,
    X26=yesno(lifestyle_advice.Long_Illness.X26, T),
    X27=freq3c(lifestyle_advice.Long_Illness.X27)
  )]
)

tbl_svysummary(
  d,
  include = c(
    X26,
    X27
  ),
  label = list(
    X26 ~ "Etes-vous en longue maladie (X26)",
    X27 ~ "Laquelle (X27)"
  ),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "no"
) |>
  modify_header(label ~ "") |>
  add_ci(
    statistic = list(all_dichotomous() ~ "{conf.low} - {conf.high}"),
    pattern = "{stat} ({ci})"
  )  |>
  modify_header(stat_0 = "**Pourcentage (IC 95%)**") |>
  modify_footnote(update = everything() ~ NA)

```


